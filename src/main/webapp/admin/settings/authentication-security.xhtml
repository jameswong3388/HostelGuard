<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/templates/admin-layout.xhtml">

    <!-- Page Title -->
    <ui:define name="title">Users</ui:define>

    <!-- Navigation links -->
    <ui:define name="navigation">
        <h:link outcome="/admin/settings/general.xhtml"
                styleClass="py-2 text-gray-500 hover:text-gray-700 focus:outline-none">
            General
        </h:link>
        <h:link outcome="/admin/settings/account.xhtml"
                styleClass="py-2 text-gray-500 hover:text-gray-700 focus:outline-none">
            Account
        </h:link>
        <h:link outcome="/admin/settings/authentication-security.xhtml"
                styleClass="py-2 text-blue-600 font-medium focus:outline-none">
            Authentication &amp; Security
        </h:link>
    </ui:define>

    <!-- Main content -->
    <ui:define name="content">
        <h:form>
            <div class="space-y-10">

                <!-- Password Section -->
                <section aria-labelledby="password-settings">
                    <div class="grid grid-cols-1 gap-x-14 gap-y-8 md:grid-cols-3">
                        <!-- Left column: heading & description -->
                        <div>
                            <h2 id="password-settings" class="scroll-mt-10 font-semibold text-gray-900">
                                Password
                            </h2>
                            <p class="mt-1 text-sm leading-6 text-gray-500">
                                Strengthen your account by ensuring your password is strong.
                                <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-strong-password"
                                   target="_blank"
                                   class="text-indigo-600 hover:underline hover:underline-offset-4">
                                    Learn more about creating a strong password.
                                </a>
                            </p>
                        </div>

                        <!-- Right column: Old + New Password Form -->
                        <div class="md:col-span-2">

                            <!-- Old (Current) Password -->
                            <div class="mb-4">
                                <h:outputLabel for="oldPassword" value="Current password" styleClass="font-medium"/>
                                <p:password id="oldPassword"
                                            value="#{SettingsControllerAdmin.oldPassword}"
                                            styleClass="mt-2 w-full"
                                            autocomplete="current-password"
                                            required="true"
                                            requiredMessage="Current password is required"/>
                            </div>

                            <!-- New Password -->
                            <div class="mb-4">
                                <h:outputLabel for="newPassword" value="New password" styleClass="font-medium"/>
                                <p:password id="newPassword"
                                            value="#{SettingsControllerAdmin.newPassword}"
                                            styleClass="mt-2 w-full"
                                            autocomplete="new-password"
                                            required="true"
                                            requiredMessage="New password is required"
                                            feedback="true"
                                            promptLabel="Please enter a password"
                                            weakLabel="Weak"
                                            goodLabel="Good"
                                            strongLabel="Strong"/>
                            </div>

                            <!-- Confirm New Password -->
                            <div class="mb-4">
                                <h:outputLabel for="confirmNewPassword" value="Confirm new password" styleClass="font-medium"/>
                                <p:password id="confirmNewPassword"
                                            value="#{SettingsControllerAdmin.confirmNewPassword}"
                                            styleClass="mt-2 w-full"
                                            autocomplete="new-password"
                                            required="true"
                                            requiredMessage="Password confirmation is required"/>
                            </div>

                            <!-- Change Password Button -->
                            <p:commandButton value="Change password"
                                             action="#{SettingsControllerAdmin.updatePassword}"
                                             update="@form messages"
                                             styleClass="p-button-raised p-button-primary"/>
                        </div>
                    </div>
                </section>

                <!-- Divider -->
                <hr class="border-gray-300" />

                <!-- Two-Factor Authentication Section -->
                <section aria-labelledby="two-factor-authentication">
                    <div class="grid grid-cols-1 gap-x-14 gap-y-8 md:grid-cols-3">
                        <!-- Left column: heading & description -->
                        <div>
                            <h2 id="two-factor-authentication" class="scroll-mt-10 font-semibold text-gray-900">
                                Two-factor authentication
                            </h2>
                            <p class="mt-1 text-sm leading-6 text-gray-500">
                                Two-factor authentication adds an additional layer of security to your account by
                                requiring more than just a password to sign in.
                                <a href="https://docs.github.com/en/authentication/securing-your-account-with-two-factor-authentication-2fa"
                                   target="_blank"
                                   class="text-indigo-600 hover:underline hover:underline-offset-4">
                                    Learn more about two-factor authentication.
                                </a>
                            </p>
                        </div>

                        <!-- Right column: 2FA settings -->
                        <div class="md:col-span-2 space-y-6">
                            <!-- Preferred 2FA method -->
                            <div class="p-4 border border-gray-200 rounded-md">
                                <h4 class="text-sm font-medium text-gray-900 mb-2">
                                    Preferred 2FA method
                                </h4>
                                <p:selectOneMenu id="preferred2fa"
                                                 styleClass="w-full max-w-xs">
                                    <f:selectItem itemLabel="Authenticator App" itemValue="AUTH_APP" />
                                    <f:selectItem itemLabel="SMS/Text Message" itemValue="SMS" />
                                    <f:selectItem itemLabel="GitHub Mobile" itemValue="GITHUB_MOBILE" />
                                    <f:selectItem itemLabel="Security Keys" itemValue="SECURITY_KEYS" />
                                </p:selectOneMenu>
                                <p class="mt-2 text-sm text-gray-500">
                                    Set your preferred method to use for two-factor authentication.
                                </p>
                            </div>

                            <!-- Two-factor methods list -->
                            <div class="border border-gray-200 rounded-md">
                                <div class="p-4">
                                    <h4 class="text-sm font-medium text-gray-900">
                                        Two-factor methods
                                    </h4>
                                    <ul class="mt-4 space-y-4">
                                        <!-- Authenticator app -->
                                        <li class="flex justify-between">
                                            <div>
                                                <span class="font-medium">Authenticator app</span>
                                                <span class="ml-1 text-sm text-green-600">Configured</span>
                                                <p class="text-sm text-gray-500">
                                                    Use an authenticator app or browser extension to get codes.
                                                </p>
                                            </div>
                                            <p:commandButton value="Edit"
                                                             action="#{SettingsControllerAdmin.editAuthApp}"
                                                             update="@form messages"
                                                             styleClass="p-button-text p-button-sm" />
                                        </li>
                                        <!-- SMS/Text message -->
                                        <li class="flex justify-between">
                                            <div>
                                                <span class="font-medium">SMS/Text message</span>
                                                <p class="text-sm text-gray-500">
                                                    Get one-time codes via SMS to complete authentication.
                                                </p>
                                            </div>
                                            <p:commandButton value="Add"
                                                             action="#{SettingsControllerAdmin.addSmsMethod}"
                                                             update="@form messages"
                                                             styleClass="p-button-text p-button-sm" />
                                        </li>
                                        <!-- Security keys -->
                                        <li class="flex justify-between">
                                            <div>
                                                <span class="font-medium">Security keys</span>
                                                <p class="text-sm text-gray-500">
                                                    WebAuthn credentials that can only be used as a second factor.
                                                </p>
                                            </div>
                                            <p:commandButton value="Edit"
                                                             action="#{SettingsControllerAdmin.editSecurityKeys}"
                                                             update="@form messages"
                                                             styleClass="p-button-text p-button-sm" />
                                        </li>
                                        <!-- GitHub Mobile -->
                                        <li class="flex justify-between">
                                            <div>
                                                <span class="font-medium">GitHub Mobile</span>
                                                <span class="ml-1 text-sm text-green-600">Configured (2 devices)</span>
                                                <p class="text-sm text-gray-500">
                                                    Can be used for 2FA by installing GitHub Mobile and signing in.
                                                </p>
                                            </div>
                                            <p:commandButton value="Show"
                                                             action="#{SettingsControllerAdmin.showGithubMobileDevices}"
                                                             update="@form messages"
                                                             styleClass="p-button-text p-button-sm" />
                                        </li>
                                        <!-- Recovery codes -->
                                        <li class="flex justify-between">
                                            <div>
                                                <span class="font-medium">Recovery codes</span>
                                                <span class="ml-1 text-xs text-yellow-600">Viewed</span>
                                                <p class="text-sm text-gray-500">
                                                    Recovery codes can be used to access your account if you lose your device.
                                                </p>
                                            </div>
                                            <p:commandButton value="View"
                                                             action="#{SettingsControllerAdmin.viewRecoveryCodes}"
                                                             update="@form messages"
                                                             styleClass="p-button-text p-button-sm" />
                                        </li>
                                    </ul>
                                </div>
                                <div class="border-t border-gray-200 bg-gray-50 p-4">
                                    <p class="text-sm text-gray-500">
                                        You can configure multiple methods for flexibility and redundancy.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Divider -->
                <hr class="border-gray-300" />

                <!-- Web Sessions Section -->
                <section aria-labelledby="web-sessions">
                    <div class="grid grid-cols-1 gap-x-14 gap-y-8 md:grid-cols-3">
                        <!-- Left column: heading & description -->
                        <div>
                            <h2 id="web-sessions" class="scroll-mt-10 font-semibold text-gray-900">
                                Web sessions
                            </h2>
                            <p class="mt-1 text-sm leading-6 text-gray-500">
                                This is a list of devices that have logged into your account. Revoke any sessions
                                that you do not recognize.
                            </p>
                        </div>

                        <!-- Right column: session list -->
                        <div class="md:col-span-2 space-y-6">
                            <!-- Example session card -->
                            <div class="p-4 border border-gray-200 rounded-md flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-900">
                                        Kuala Lumpur 172.226.44.182
                                        <span class="ml-2 inline-block text-green-600 text-xs">
                                            Your current session
                                        </span>
                                    </p>
                                    <p class="mt-1 text-sm text-gray-500">
                                        Seen in BN, MY, SG
                                    </p>
                                </div>
                                <p:commandButton value="See more"
                                                 action="#{SettingsControllerAdmin.viewSessionDetails}"
                                                 update="@form messages"
                                                 styleClass="p-button-text p-button-sm" />
                            </div>
                            <!-- Add more session items as needed... -->
                        </div>
                    </div>
                </section>

                <!-- Divider -->
                <hr class="border-gray-300" />

                <!-- GitHub Mobile Sessions Section -->
                <section aria-labelledby="github-mobile-sessions">
                    <div class="grid grid-cols-1 gap-x-14 gap-y-8 md:grid-cols-3">
                        <!-- Left column: heading & description -->
                        <div>
                            <h2 id="github-mobile-sessions" class="scroll-mt-10 font-semibold text-gray-900">
                                GitHub Mobile sessions
                            </h2>
                            <p class="mt-1 text-sm leading-6 text-gray-500">
                                This is a list of devices that have logged into your account via the GitHub Mobile app.
                                Revoke any session that you do not recognize, or
                                <a href="#" class="text-indigo-600 hover:underline hover:underline-offset-4">
                                    revoke
                                </a>
                                your GitHub Mobile app authorization to sign out of all your devices.
                            </p>
                        </div>

                        <!-- Right column: mobile session list -->
                        <div class="md:col-span-2 space-y-6">
                            <!-- Example device 1 -->
                            <div class="p-4 border border-gray-200 rounded-md flex items-start justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-900">
                                        iPad, iPad14,3
                                    </p>
                                    <p class="text-sm text-gray-500">
                                        Registered – Aug 25, 2023
                                    </p>
                                    <p class="text-sm text-gray-500">
                                        Last accessed – Jan 19, 2025
                                    </p>
                                    <p class="text-sm text-gray-500">
                                        Last used for authentication – Never used
                                    </p>
                                </div>
                                <p:commandButton value="Revoke"
                                                 action="#{SettingsControllerAdmin.revokeMobileSession}"
                                                 update="@form messages"
                                                 styleClass="p-button-danger p-button-text p-button-sm" />
                            </div>

                            <!-- Example device 2 -->
                            <div class="p-4 border border-gray-200 rounded-md flex items-start justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-900">
                                        M2007JS3G
                                    </p>
                                    <p class="text-sm text-gray-500">
                                        Registered – Jun 29, 2022
                                    </p>
                                    <p class="text-sm text-gray-500">
                                        Last accessed – Jan 8, 2025
                                    </p>
                                    <p class="text-sm text-gray-500">
                                        Last used for authentication – Dec 31, 2024
                                    </p>
                                </div>
                                <p:commandButton value="Revoke"
                                                 action="#{SettingsControllerAdmin.revokeMobileSession}"
                                                 update="@form messages"
                                                 styleClass="p-button-danger p-button-text p-button-sm" />
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Divider -->
                <hr class="border-gray-300" />

                <!-- (Optional) Danger Zone Section -->
                <section aria-labelledby="danger-zone">
                    <div class="grid grid-cols-1 gap-x-14 gap-y-8 md:grid-cols-3">
                        <div>
                            <h2 id="danger-zone"
                                class="scroll-mt-10 font-semibold text-gray-900 ">
                                Danger zone
                            </h2>
                            <p class="mt-1 text-sm leading-6 text-gray-500">
                                High-impact actions. Proceed with caution!
                            </p>
                        </div>

                        <div class="space-y-6 md:col-span-2">
                            <!-- Example: Revoke all sessions -->
                            <div class="p-4 border border-gray-200 rounded-md flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">
                                        Sign out everywhere
                                    </h4>
                                    <p class="mt-2 text-sm leading-6 text-gray-500">
                                        Revoke all active web and mobile sessions. You'll be asked to sign in again.
                                    </p>
                                </div>
                                <p:commandButton value="Sign out everywhere"
                                                 action="#{SettingsControllerAdmin.revokeAllSessions}"
                                                 update="@form messages"
                                                 styleClass="p-button-danger" />
                            </div>
                        </div>
                    </div>
                </section>

            </div>
        </h:form>
    </ui:define>
</ui:composition>
